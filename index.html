<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Don't Hurt Yourself</h1>
					<h3>Adopting AngularJS in Existing Applications</h3>
					<h4>
						<a href="http://www.alexandraatzl.com">Alexandra Atzl</a> | <a href="http://twitter.com/alexandraatzl">@alexandraatzl</a>
					</h4>
					<h4>UI Developer at <a href="http://www.effectiveui.com">EffectiveUI</a> | Rochester, NY</h4>
				</section>

				<section>
					<h2>Disclaimer</h2>
					<aside class="notes">
					A lot of this talk may seem obvious to a lot of you. You might think, duh, this is fairly common knowledge. But I've seen apps that don't follow my suggestions, so they're worth mentioning and calling out.
					</aside>
				</section>

				<section>
					<h2>The Problem</h2>
					<aside class="notes">
						You're working for a client, and you're given Angular code that really only uses controllers. You have limited time, budget, and resources, but you need to make this code align more with Angular concepts, and you need it to be more modular, testable, and scalable.
					</aside>
				</section>

				<section>
					<h2>Common Pitfalls</h2>

					<ul>
						<li class="fragment">Placing multiple objects in a single file.</li>
						<li class="fragment">Using global variables</li>
						<li class="fragment">Not using Angular's built-in services.</li>
						<li class="fragment">Putting business logic in controllers</li>
						<li class="fragment">Repeating base objects, constant values, etc.</li>
					</ul>

					<aside class="notes">
					 ex. using setTimeout instead of $timeout, putting 5 controllers in a single file, etc.
					</aside>
				</section>

				<section>
					<h2>Take Advantage of Everything Available</h2>
					<p>If you're given an entire toolbox with which to build a bookshelf, why would you insist on doing everything using only the hammer?</p>
				</section>

				<section>
					<h2>So where do we start?</h2>
				</section>

				<section>
					<section>
						<h2>Break up files.</h2>
						<h4>Every component should have its own folder, and every controller/service/directive should have its own Javascript file.</h4>
					</section>

					<aside class="notes">
						The extra time taken is worth it in the long run. This way, you can more easily find specific files you may need, etc.
					</aside>
				</section>

				<section>
					<aside class="notes">
						<ul>
							<li>service is a singleton, so we know we're only ever dealing with that one instance</li>
							<li>Angular will tell us if another servie of the same name is created, so there's no chance we'll inadvertently overwrite the object or its properties</li>
						</ul>
					</aside>

					<section>
						<h2>Create Services</h2>
						<h4>Eliminate global variables by wrapping them in services.</h4>

						<aside class="notes">
							Most of these can be wrapped in an Angular service, and you can use dependency injection to make them available in the controllers where you need them.
						</aside>
					</section>

					<section>
						<h3>Example: Global Object</h3>
						<pre><code data-trim>
angular.module('app')
	.controller('MyCtrl', function($scope) {
		// What is moment? How do I know this exists and is the object I want?
		$scope.startTime = moment();
		$scope.endTime = moment().add(1, 'h');
	});
						</code></pre>
					</section>

					<section>
						<aside class="notes">
						Advantage: guaranteeing you have it on controller level; also, can set jshint to not allow access to global variables unless you explicitly allow it.
						Plus! Then, you can mock it out when testing.
						</aside>
						<h3>Example: Wrapped in a Service</h3>
						<pre><code data-trim>
angular.module('app')
	.service('moment', function($window) {
		return $window.moment;
	})
	.controller('MyCtrl', function($scope, moment) {
		$scope.startTime = moment();
		$scope.endTime = moment().add(1, 'h');
	});
						</code></pre>
					</section>

					<section>
						<h2>It works for custom objects, too!</h2>
						<h4>Use this  method for any custom global objects you've created as well.</h4>
					</section>

					<section>
						<h3>Example: Global Object</h3>
						<pre>
							<code class="javascript">
var zoo = {
	animals: null,
	getAnimals: function() {
		return this.animals;
	}
}

angular.module('app')
	.controller('ZooCtrl', function($scope) {
		// hope that zoo exists somewhere
		$scope.myAnimals = zoo.getAnimals();
	});
							</code>
						</pre>
					</section>

					<section>
					<aside class="notes">
					you don't have to changemuch, just add a dependency, and set up the globals in a smarter way.
					</aside>
						<h3>Example: Wrapped in a Service</h3>
						<pre>
							<code data-trim>
	angular.module('app')
		.factory('zoo', function(){
			var animals = null;
			return {
				getAnimals: function() {
					return animals;
				}
			};
		})
		.controller('ZooCtrl', function($scope, zoo) {
			$scope.myAnimals = zoo.getAnimals();
		});
							</code>
						</pre>
						<aside class="notes">
							<ul>
								<li>now we can leverage dependency injection</li>
								<li>our code is more modular and testable</li>
							</ul>
						</aside>
					</section>
				</section>

				<section>
					<section>
						<h2>Use all the tools available to you</h2>
						<h4>Angular's built-in services make life easier. Use them!</h4>
					</section>

					<section>
						<h3>Example: Grabbing data from a server</h3>
						<pre>
							<code data-trim>
	angular.module('app')
		.factory('addressBookService', function(){
			var data = null;

			return {
				getAddresses: function() {
					$.ajax({
						url: '/path/to/data',
						dataType: 'json',
						success: function(result) {
							data = result;
						},
						error: function(error) {

						}
					});
				}
			};
		});
							</code>
						</pre>
					</section>

					<section>
					<aside class="notes">
					why return the promise itself?? explain.
					</aside>
						<h3>Example: Using Angular's $http service</h3>
						<pre>
							<code data-trim>
	angular.module('app')
		.factory('addressBookService', function($http) {
			return {
				getAddresses: function() {
					return $http({
						method: 'GET',
						url: '/path/to/data'
					});
				}
			};
		})
							</code>
						</pre>
						<aside class="notes">
							<ul>
						<li>using $http lets you use $httpInterceptors, whereas jQuery's $.ajax() will not</li>
					</ul>
						</aside>
					</section>

					<section>
					<aside class="notes">

					</aside>
						<h2>commonly used built-in services</h2>
						<h4>
							<ul>
								<li>$http</li>
								<li>$window</li>
								<li>$document</li>
								<li>$location</li>
								<li>$animate</li>
								<li>$filter</li>
								<li>$q</li>
								<li>$timeout</li>
							</ul>
						</h4>
					</section>
				</section>

				<section>
					<section>
						<aside class="notes">
							a lot of times, people learn controllers first, so they put everything in there when they shouldn't.
						</aside>
						<h2>Keep business logic out of controllers</h2>
						<h4>Abstract this logic into services instead.</h4>

						<aside class="notes">

						</aside>
					</section>

				<!-- 	<section>
						<h3>Example: Controller riddled with excess logic</h3>
						<pre>
							<code data-trim>
							// foo
							</code>
						</pre>
					</section>

					<section>
						<h3>Example: Abstracting logic out into a service</h3>
						<pre>
							<code data-trim>
							// bar
							</code>
						</pre>
					</section> -->
				</section>

				<section>
					<aside class="notes">
						<ul>
							<li>sometimes you use globals for constants, configuration objects, etc.</li>
							<li>using Angular.value or angular.constant provides a better way to do that</li>
							<li>then you can use dependency injection</li>
						</ul>
					</aside>
					<section>
						<h2>Utilize Angular Values &amp; Constants</h2>
						<h4>If you commonly need to use the same values, don't add them to every controller individually!</h4>
					</section>

					<section>
						<h3>Example: Repeated Code</h3>
						<pre><code data-trim>
	angular.module('todoListApp')
		.controller('workToDos', function($scope) {
			var BASE_TODO = {
				dueDate: null,
				text: '',
				id: 0,
				isCompleted: false
			};

			$scope.baseWorkTodo = angular.copy(BASE_TODO);
			$scope.baseWorkTodo.project = {
				id: 1,
				text: 'ngVegas talk'
			};
		})
		.controller('personalToDos', function($scope) {
			var BASE_TODO = {
				dueDate: '2015-05-08',
				text: 'Respond to emails.',
				id: 0,
				isCompleted: false
			};

			$scope.basePersonalTodo = angular.copy(BASE_TODO);
			$scope.basePersonalTodo.location = 'Las Vegas, NV';
		});
						</code></pre>
					</section>

					<section>
						<h3>Example: Using Angular values</h3>
						<pre>
							<code data-trim>
angular.module('todoListApp')
	.value('baseTodoObject', {
		dueDate: null,
		text: '',
		id: 0,
		isCompleted: false
	})
	.controller('workToDos', function($scope, baseTodoObject) {
		$scope.baseWorkTodo = angular.copy(baseTodoObject);
		$scope.baseWorkTodo.project = {
			id: 1,
			text: 'ngVegas talk'
		};
	})
	.controller('personalToDos', function($scope, baseTodoObject) {
		$scope.basePersonalTodo = angular.copy(baseTodoObject);
		$scope.basePersonalTodo.location = 'Las Vegas, NV';
	});
							</code>
						</pre>
					</section>
				</section>

				<!-- <section>
					<section>
						<h2>Modularize your code</h2>
						<h4>If you're doing the same thing in multiple places, pull that logic out into a directive and reuse it that way.</h4>
					</section>

					<section>
						<h3>Example: </h3>
						<pre>
							<code data-trim>
								// code goes here
							</code>
						</pre>
					</section>

					<section>
						<h3>Example: </h3>
						<pre>
							<code data-trim>
								// code goes here
							</code>
						</pre>
					</section>
				</section> -->

				<section>
					<section>
						<h2>Take things a step further</h2>
						<h4>Do you have multiple controllers that do <em>almost</em> the same thing? Try creating a base controller and extending it for each use case.</h4>

						<aside class="notes">
						More testable! Cleaner!
						</aside>
					</section>

					<section>
						<h3>Example:</h3>
						<pre><code data-trim>
	angular.module('app')
		.controller('catCtrl', function($scope) {
			$scope.name = 'Grumpy';
			$scope.prey = [ 'mouse', 'mouse' ];
			$scope.eat = function () {
				$scope.prey.pop();
			};
			$scope.numLegs = 4;

			$scope.move = function() {};

			$scope.breathe = function() {
				// something here
			};
		})
		.controller('fishCtrl', function($scope) {
			$scope.name = 'Nemo';
			$scope.prey = [ 'algae' ];
			$scope.eat = function() {
				$scope.prey.pop();
			};
			$scope.numLegs = 0;

			$scope.move = function() {};

			$scope.breathe = function() {
				// something here
			};
		});
						</code></pre>
					</section>

					<section>
						<h3>Example: </h3>
						<pre><code data-trim>
	angular.module('app')
		.controller('animalCtrl', function($scope) {
			$scope.name = '';
			$scope.prey = [];
			$scope.numLegs = null;
			$scope.move = null;

			$scope.eat = function() {
				$scope.prey.pop();
			};

			$scope.breathe = function() {
				// something here
			};
		});
						</code></pre>

					</section>

					<section>
						<h3>Example:</h3>
						<pre><code data-trim>
	app.controller('catCtrl', function($scope, $controller) {
		// inherit $scope of baseCtrl
		$controller('animalCtrl', {
			$scope: $scope
		});

	  // now override $scope properties as necessary;
		$scope.name = 'Grumpy';
		$scope.numLegs = 4;
		$scope.prey = [ 'mouse', 'mouse', 'mouse' ];

		var move = angular.noop;
		$scope.move = pounce;
	})
	.controller('fishControl', function($scope, $controller) {
		$controller('animalCtrl', {
			$scope: $scope
		});

		$scope.name = 'Nemo';
		$scope.numLegs = 0;
		$scope.prey = [ 'algae' ];

		var swim = angular.noop;
		$scope.move = swim;
	});
						</code></pre>
					</section>
				</section>

				<section>
					<h2>Takeaways</h2>

				</section>
			</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
